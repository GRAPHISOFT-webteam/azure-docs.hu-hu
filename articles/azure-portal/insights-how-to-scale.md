<properties 
    pageTitle="手動或自動調整執行個體計數" 
    description="了解如何調整您的 Azure 服務。" 
    authors="stepsic-microsoft-com" 
    manager="ronmart" 
    editor="" 
    services="azure-portal" 
    documentationCenter="na"/>

<tags 
    ms.service="azure-portal" 
    ms.workload="na" 
    ms.tgt_pltfrm="na" 
    ms.devlang="na" 
    ms.topic="article" 
    ms.date="09/08/2015" 
    ms.author="stepsic"/>

# 手動或自動調整執行個體計數

在 [Azure 入口網站](https://portal.azure.com/), ，您可以手動設定您的服務的執行個體計數或您可以設定參數，讓它自動根據需求進行調整。 這通常稱為 *向外延展* 或 *縮放*。

根據執行個體計數進行調整之前，您應該考慮調整會影響 **定價層** 除了執行個體計數。 不同的定價層可以有不同數目的核心和記憶體，因此將可帶來更佳的效能，相同數目的執行個體 (也就是 *向上* 或 *縮小*)。 本文特別涵蓋了 *縮放* 和 *出*。

您可以在網站中，調整，而且您也可以使用 [REST API](https://msdn.microsoft.com/library/azure/dn931953.aspx) 或 [.NET SDK](https://www.nuget.org/packages/Microsoft.Azure.Insights/) 來手動或自動調整級別。

## 手動調整

1. 在 [Azure 入口網站](https://portal.azure.com/), ，按一下 [ **瀏覽**, ，然後瀏覽至您想要調整，例如資源 **應用程式服務方案**。

2.  **小數位數** 排列 **作業** 會告訴您調整的狀態: **關閉** 當您手動調整時 **上** 則會顯示依一或多個效能度量。
    ![調整] 磚](./media/insights-how-to-scale/Insights_UsageLens.png)

3. 按一下磚帶您前往 **延展** 刀鋒視窗。 在調整分頁頂端您所見的自動調整動作歷程記錄服務。  
    ![調整分頁](./media/insights-how-to-scale/Insights_ScaleBladeDayZero.png)
    
>[AZURE.NOTE] 在此圖表會顯示自動調整所執行的動作。 如果您手動調整執行個體計數，則此變更將不會反映在該圖表中。

4. 您可以手動調整數 **執行個體** 使用滑桿。
5. 按一下 [ **儲存** 命令，您會被調整到該執行個體數目幾乎立即。 

## 根據預先設定的計量進行調整

如果您想要自動調整執行個體數目根據計量，選取您想要的度量 **調整** 下拉式清單。 例如，對於 **應用程式服務方案** 可以藉由調整 **CPU 百分比**。

1. 當您選取計量時，您會看到一個滑桿，和/或可輸入您要調整的執行個體數目範圍文字方塊：

    ![Scale blade with CPU Percentage](./media/insights-how-to-scale/Insights_ScaleBladeCPU.png) 
    
    無論負載為何，自動調整絕對不會將您的服務調整低於或高於您的設定界限。

2. 其次，您可以選擇計量的目標範圍。 例如，如果您選擇 **CPU 百分比**, ，您可以平均 cpu 設定目標，跨所有執行個體，在您的服務。 當平均 CPU 超過您所定義的最大值時，便會發生相應放大，同樣地，每當平均 CPU 低於最小值時，便會發生相應縮小。

3. 按一下 [ **儲存** 命令。 自動調整每隔幾分鐘就會檢查一次，以確定您仍在計量的執行個體範圍和目標內。 當服務收到額外流量時，您會收到多個執行個體而不會進行任何動作。

## 根據其他計量進行調整

您可以根據出現在預設以外的度量來調整 **調整** 下拉式清單中，可以更有一組複雜的相應放大和相應縮小規則。

### 新增或變更規則

1. 選擇 **排程和效能規則** 中 **調整** 下拉式清單中:
![效能規則](./media/insights-how-to-scale/Insights_PerformanceRules.png)

2. 如果您先前有過自動調整，您便會看到先前使用的確切規則的檢視。

3. 若要根據另一個指標按一下調整 **新增規則** 資料列。 您也可以按一下現有的資料列，您先前您想要調整的度量的計量變更。
![新增規則](./media/insights-how-to-scale/Insights_AddRule.png)

4. 現在，您必須選取所需的調整依據計量。 選擇計量時會有幾個考量事項：
    *  *資源* 計量的來源。 一般而言，這會與您要調整的資源相同。 不過，如果您想要根據儲存體佇列的深度進行調整，則資源就會是您的調整依據佇列。
    *  *衡量標準名稱* 本身。 
    *  *時間彙總* 的度量。 這是資料的組合上的方式 *持續時間*。
    
5. 選擇您的計量之後，您會選擇計量的臨界值，以及運算子。 例如，您可以說 **大於** **80%**。 

6. 然後選擇您要採取的動作。 共有幾種不同的動作類型：
    * 增加或減少依據-這會新增或移除 **值** 您定義的執行個體的數目
    * 增加或減少百分比 - 這會以百分比來變更執行個體計數。 例如，您可以將 25 放 **值** ] 欄位中，如果您目前有 8 個執行個體，則會增加 2。
    * 增加或減少至-這會將執行個體計數設定為 **值** 您定義。

7. 最後，您可以選擇等待期間 - 在前次調整動作之後，此規則要再次執行調整前所應等待的時間。
    
8. 設定規則之後，請按 **確定**。 

9. 一旦您已設定所有您想要的規則，務必要按 **儲存** 命令。

### 使用多個步驟進行調整

以上都是基本範例。 不過，如果您想要更靈活地相應增加 (或減少)，您甚至可以為相同的計量新增多項調整規則。 例如，您可以在 CPU 百分比上定義兩項調整規則：

1. 如果 CPU 百分比高於 60%，則相應增加 1 個執行個體
2. 如果 CPU 百分比高於 85%，則相應增加 3 個執行個體

![Multiple scale rules](./media/insights-how-to-scale/Insights_MultipleScaleRules.png)

透過這項附加規則，如果您的負載在調整動作之前超過 85%，您將會增加兩個執行個體，而不是一個。 

## 根據排程進行調整


根據預設，當您建立調整規則，一律會將套用。 當您按一下 [設定檔標頭] 時會看到：

![設定檔](./media/insights-how-to-scale/Insights_Profile.png)

不過，在一天、一週和週末當中，您可能會想要進行更積極的調整。 您甚至可以在下班時間完全關閉您的服務。

1. 若要這樣做，您必須在設定檔中，選取 **循環** 而不是 **，** 然後選擇您想要套用的設定檔的時間。

2. 例如，若在一週中，套用的設定檔 **天** 下拉式清單中取消核取 **星期六** 和 **星期日**。

3. 若要在白天套用的設定檔，設定 **開始時間** 到您想要開始的時間。
    ![預設週期](./media/insights-how-to-scale/Insights_ProfileRecurrence.png)

4. 按一下 [ **確定**。

5. 接下來，您必須新增您要在其他時候套用的設定檔。 按一下 [ **新增設定檔** 資料列。 
    ![關閉工作](./media/insights-how-to-scale/Insights_ProfileOffWork.png)

6. 您新增的第二個設定檔的名稱，例如，您可以把它 **下班**。 

7. 然後選取 **循環** 一次，並選擇您想要在這段期間的執行個體計數範圍。

8. 使用預設設定檔中，選擇 **天** 您要套用此設定檔和 **開始時間** 一天。

>[AZURE.NOTE] 自動調整將使用日光節約規則的任何 **時區** 您選取。 不過，在日光節約時間期間，UTC 時差會顯示基本的時區時差，而不是日光節約的 UTC 時差。 

9. 按一下 [ **確定**。

10. 現在，您必須新增您要在第二個設定檔期間套用的任何規則。 按一下 [ **新增規則**, ，然後您可以建構在預設設定檔相同的規則。
    ![新增規則至下班](./media/insights-how-to-scale/Insights_RuleOffWork.png)

11. 請務必建立相應放大和相應縮小這兩個規則，否則在設定檔期間，執行個體計數將只增加 (或減少)。 

12. 最後，按一下 [ **儲存**。

## 後續步驟

* [監視服務計量](insights-how-to-customize-monitoring.md) 並確認您的服務可用且可回應。
* [啟用監視和診斷](insights-how-to-use-diagnostics.md) 到您的服務中收集詳細的高頻率計量。
* [接收警示通知](insights-receive-alert-notifications.md) 每當發生操作事件或計量超過臨界值。
* [監視應用程式效能](insights-perf-analytics.md) 如果您想要了解如何您的程式碼執行定域機組中。
* [檢視事件和稽核記錄檔](insights-debugging-with-events.md) 若要了解在您的服務內發生的所有項目。
* [監視可用性和回應性的任何網頁](../app-insights-monitor-web-app-availability.md) 使用 Application Insights，因此您可以找出您的頁面是否關閉。
 
