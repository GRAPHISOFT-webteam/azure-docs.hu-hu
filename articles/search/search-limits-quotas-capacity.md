<properties
    pageTitle="Azure 搜尋服務中的服務限制 | Microsoft Azure | 雲端託管搜尋服務"
    description="Azure 搜尋服務 (託管的雲端搜尋服務) 的容量計劃中使用的服務限制，以及要求與回應的最大限制。"
    services="search"
    documentationCenter=""
    authors="HeidiSteen"
    manager="mblythe"
    editor=""
    tags="azure-portal"/>

<tags
    ms.service="search"
    ms.devlang="NA"
    ms.workload="search"
    ms.topic="article"
    ms.tgt_pltfrm="na"
    ms.date="11/19/2015"
    ms.author="heidist"/>


# Azure 搜尋中的服務限制

儲存體與工作負載的最大限制，以及索引、文件和其他物件的數量上限皆取決於您如何訂閱 Azure 搜尋。 免費服務是用來進行評估和概念證明測試，其中的所有物件和工作負載都有較低限制，如此一來就能更合理的共用資源。

標準層級在僅供您服務專用的機器上執行。 單獨使用專用服務可讓您相應增加或減少，在各層級具有更多的儲存和處理容量，包括最小組態。

## 免費 (共用) 搜尋服務的最大限制

Azure 訂閱者可以將共用 (多租用戶) 的搜尋服務應用在開發或非常小的搜尋應用程式上。 共用的服務隨附於您的 Azure 訂閱。 此免費選項可讓您在註冊之前就能利用服務來實驗。 它提供：

[AZURE.INCLUDE [azure-search-limits](../../includes/azure-search-limits-free.md)]

請注意這裡沒有與查詢相關聯的配額或最大限制。 每秒查詢 (QPS) 會根據可用的頻寬和系統資源的爭用而有所不同。 可備份共用服務的 Azure 計算和儲存體資源由多個訂閱者共用，因此您解決方案的 QPS 會根據有多少其他工作負載在同時執行而有所不同。

## 標準 (專用) 搜尋服務最大限制

在 Standard 價格區間下，專用搜尋服務僅會儲存您的資料並僅執行您的工作負載。 與共用服務不同，您可將專用搜尋服務的資源配置調整為任何所需要的層級。 您可以獨立設定資源的層級以供資料分割 (若要相應增加儲存體) 和複本 (以提供高可用性並相應增加 QPS 和索引效能) 使用。 請參閱 [管理搜尋方案](search-manage.md) 的深入了解不同的資源設定。

下表是一份上限清單，但您應該檢閱矩陣圖表進一步上的了解允許的容量 [的資料分割和複本組合](#chart)。

[AZURE.INCLUDE [azure-search-limits](../../includes/azure-search-limits-standard.md)]

您可以購買 Azure 搜尋容量來增加名為「搜尋單位數」的額度。 Standard 價格區間在每個搜尋服務中允許最多 36 個搜尋單位數。 這項限制會覆寫資料分割和複本的個別限制。 例如，您無法將您的服務相應增加至 12 個資料分割和 6 個複本，因為這樣做需要 72 個搜尋單位數 (12 x 6)，超過每個服務 36 個搜尋單位數的限制。

## 關於資料分割和複本

「資料分割」****提供儲存體和 IO。 單一搜尋服務最多可以有 12 個資料分割。 每個資料分割隨附 1 千 5 百萬個文件或 25 GB 儲存體的固定限制，以第一個達到的限制為準。 如果您新增資料分割，您的搜尋服務就可以載入更多文件。 例如，在您將第二個資料分割加入服務後，服務的單一資料分割就能從原本最多只能儲存 25 GB 的資料，變為可以儲存 50 GB。

「複本」****是搜尋引擎的複本。 單一搜尋服務最多可以有 6 個複本。 您需要至少 2 個複本供讀取 (查詢) 可用性使用，以及至少 3 個複本供讀取/寫入 (查詢、索引) 可用性使用。

每個索引的複本在各自的複本上執行。 當您新增複本時，索引的其他複本會回到線上以支援更高的查詢工作負載並負載平衡多個複本上的要求。 如果您有多個索引，例如 6 個索引和 3 個複本，則每個複本將會有一份完整的 6 個索引。

請注意，由於執行查詢可能會因為查詢和爭用工作負載的複雜性而有相當程度的出入，因此我們在每秒查詢 (QPS) 上不提供任何硬性的估計。 平均來說，一個複本可以提供約 15 QPS 的服務，但您的輸送量會因為查詢的複雜性 (多面向查詢會更複雜) 和網路延遲而稍微較高或較低。 此外，請務必了解雖然新增複本會明顯地增加規模和效能，但是最終結果並不會完全地呈線性關係：新增 3 個複本並不保證有 3 倍的輸送量。 出現查詢延遲則代表可能需要額外的複本。

<a id="chart"></a>
## 支援的分割和複本組合

如先前所述，資料分割和複本的有效限制是基於您所選取的資源組合，而侷限在每個服務 36 個搜尋單位數的範圍內。 資源會依據搜尋單位數 (SU) 配置。 專用搜尋服務都會以一個複本和一個資料分割為一個搜尋單位做為開始。

額外容量的計算方式為資料分割數乘以複本數，可產生支援指定設定所需的搜尋單位數的總數。

下表是垂直軸代表複本數且水平軸代表資料分割數的圖表。 交集會顯示支援每個組合所需的搜尋單位數，其受限於每個服務 36 個搜尋單位數 (SU) 的限制。 例如，若您想要 6 個複本和 2 個資料分割，則此設定需要 12 個搜尋單位數。 若要使用 4 個複本和 2 個資料分割，則您需要 8 個搜尋單位數。 做為一般的規則而言，大部分的搜尋應用程式通常需要比資料分割多的複本。

<table cellspacing="0" border="1">
<tr><td><b>12 個複本</b></td><td>12 SU</td><td>24 SU</td><td>36 SU</td><td>N/A</td><td>N/A</td><td>N/A</td></tr>
<tr><td><b>6 個複本</b></td><td>6 SU</td><td>12 SU</td><td>18 SU</td><td>24 SU</td><td>36 SU</td><td>N/A</td></tr>
<tr><td><b>5 個複本</b></td><td>5 SU</td><td>10 SU</td><td>15 SU</td><td>20 SU</td><td>30 SU</td><td>N/A</td></tr>
<tr><td><b>4 個複本</b></td><td>4 SU</td><td>8 SU</td><td>12 SU</td><td>16 SU</td><td>24 SU</td><td>N/A </td></tr>
<tr><td><b>3 個複本</b></td><td>3 SU</td><td>6 SU</td><td>9 SU</td><td>12 SU</td><td>18 SU</td><td>36 SU</td></tr>
<tr><td><b>2 個複本</b></td><td>2 SU</td><td>4 SU</td><td>6 SU</td><td>8 SU</td><td>12 SU</td><td>24 SU</td></tr>
<tr><td><b>1 個複本</b></td><td>1 SU</td><td>2 SU</td><td>3 SU</td><td>4 SU</td><td>6 SU</td><td>12 SU</td></tr>
<tr><td>N/A</td><td><b>1 個資料分割</b></td><td><b>2 個資料分割</b></td><td><b>3 個資料分割</b></td><td><b>4 個資料分割</b></td><td><b>6 個資料分割</b></td><td><b>12 個資料分割</b></td></tr>
</table>

搜尋單位數、定價和容量會在 Azure 網站上詳細說明。 請參閱 [定價詳細資料](http://azure.microsoft.com/pricing/details/search/) 如需詳細資訊。
> [AZURE.NOTE] 複本數和資料分割數必須能整除 12 (明確來說就是 1、2、3、4、6、12)。 這是因為 Azure 搜尋預先將每個索引分成 12 個分區，這樣就可將其加以散佈在資料分割中。 例如，如果您的服務有三個資料分割，而您建立了新的索引，則每個資料分割將會包含 4 個該索引的分區。 Azure 搜尋將索引分區的方法是實作細節，有可能在未來版本中變更。 雖然現在分區數為 12，但您不應預期未來該數字永遠都會是 12。

## 選擇高可用性的資料分割和複本組合

由於相應增加非常快速簡單，我們通常建議您從一個資料分割和一或兩個複本開始，然後於查詢量增長時再相應增加。 對於許多部署中，一個資料分割會提供足夠的儲存體和 IO (在每個資料分割的 15 萬個文件)。

然而查詢工作負載需依據複本。 如果您需要更多的輸送量或高可用性，就可能需要額外複本。

高可用性的一般建議事項為：

- 針對唯讀工作負載 (查詢) 的高可用性為 2 個複本
- 針對讀取/寫入工作負載 (查詢和索引) 的高可用性為 3 或更多個複本

目前沒有任何內建的機制可進行災害復原。 因此新增資料分割或複本並不是達成災害復原目標的正確選擇。 相反地，您可以考慮在服務等級新增備援。 如需因應措施的深入討論，請參閱 [這個論壇文章](https://social.msdn.microsoft.com/Forums/ee108a26-00c5-49f6-b1ff-64c66c8b828a/dr-and-high-availability-for-azure-search?forum=azuresearch)。
> [AZURE.NOTE] 請回想一下，服務等級協定和延展性是標準服務的功能。 免費服務會於固定的資源層級提供，而複本和資料分割會由多個訂閱者共用。 如果您在開始時使用免費服務而現在想要升級，您必須在標準層級建立新的 Azure 搜尋服務，再將索引和資料重新載入至此新服務中。 請參閱 [入口網站中建立 Azure 搜尋服務](search-create-service-portal.md) 如需佈建服務的指示。

## API 金鑰限制

API 金鑰可用於服務驗證。 有兩種類型。 系統管理金鑰在要求標頭中指定。 查詢金鑰在 URL 上指定。 請參閱 [管理搜尋服務在 Microsoft Azure 上的](search-manage.md) 如需金鑰管理的詳細資訊。

- 每個服務最多 2 個系統管理金鑰
- 每個服務最多 50 個查詢金鑰

## 要求限制

- 每個要求上限為 16 MB <sup>1</sup>
- 最長 8 KB 的 URL 長度
- 每個索引上傳、合併、或刪除批次最多包含 1000 個文件
- $orderby 子句中最多 32 個欄位
- 最大搜尋詞彙的大小是 utf-8 編碼文字的 32766 個位元組 (32 KB 減 2 個位元組)

## 回應限制

- 每一頁搜尋結果最多傳回 1000 個文件
- 每個建議 API 要求最多傳回 100 個建議

<sup>1</sup> 中 「 Azure 搜尋服務中，要求的主體受限於，上限是 16 MB，賦予個別欄位的集合，否則不限制理論限制的內容上的實際限制 (請參閱 [支援的資料類型](https://msdn.microsoft.com/library/azure/dn798938.aspx) 如需有關欄位組合和限制)。




