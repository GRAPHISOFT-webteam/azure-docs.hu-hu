<properties
    pageTitle="Azure 搜尋服務中的索引 | Microsoft Azure | 雲端託管搜尋服務"
    description="Azure 搜尋服務中的索引是什麼？如何使用？"
    services="search"
    documentationCenter=""
    authors="HeidiSteen"
    manager="mblythe"
    editor=""
    tags="azure-portal"/>

<tags
    ms.service="search"
    ms.devlang="na"
    ms.workload="search"
    ms.topic="get-started-article"
    ms.tgt_pltfrm="na"
    ms.date="11/09/2015"
    ms.author="heidist"/>


# Azure 搜尋服務中的索引

> [AZURE.SELECTOR]
- [Overview](search-what-is-an-index.md)
- [Portal](search-create-index-portal.md)
- [.NET](search-create-index-dotnet.md)
- [REST](search-create-index-rest-api.md)


Azure 搜尋是一種提供搜尋引擎的雲端託管搜尋服務，此搜尋引擎的搜尋功能可讓您在自訂應用程式中使用 Bing 或 Google 等工具、使用 .NET 和 REST API 將 Azure 搜尋服務與您的 Web 或桌面應用程式整合，和以「索引」**的形式對您的搜尋相關資料進行資料儲存。

## 什麼是索引？

*索引*是對 Azure 搜尋服務所使用的*文件*和其他建構所做的持續性儲存。 文件是可搜尋資料的基本單位。 比方說，零售商可能對每個 SKU 有一份文件、新聞組織可能對每個文章有一份文件，以及串流的媒體組織可能對媒體庫中的每個視訊或歌曲有一份文件。 對應這些概念到更熟悉的資料庫同等項目：*索引*在概念上類似於*資料表*，而*文件*大致上相當於資料表中的*資料列*。

索引是一般的資料集 - 通常是在正常營運期間透過電腦化程序，例如銷售交易、內容發佈、購買活動所建立或擷取資料的子集 - 通常儲存在關聯式或 NoSQL 資料庫中。 從其他資料來源推送或提取包含資料列的資料集到索引時，索引會取得其文件。

## 何時建立索引？

在佈建您的應用程式所使用的搜尋服務時，您需要建立索引。 讓索引可用於搜尋作業的工作分為 2 個部分。 第 1 個部分，定義結構描述並將它張貼至 Azure 搜尋服務。 第 2 個部分，以符合此結構描述的使用者定義資料集填入索引。

若要建立可定義索引的結構描述，您可以使用入口網站，或撰寫會呼叫 .NET SDK 或 REST API 的程式碼 (請參閱此主題頂端的索引標籤)。 如需詳細資訊資料擷取會在建立索引之後，請參閱 [匯入資料到 Azure 搜尋服務](search-what-is-data-import.md)。

## 索引的 JSON 結構描述規格

索引是 JSON 文件，具有欄位和屬性、評分設定檔、建議工具、預設評分設定檔和 CORS 選項的區段。

 ![][1]

Azure 搜尋服務索引的主要區段以 JSON 資料交換格式表達，如下所示。

| 區段| 說明|
|--------------|-----------|
| 欄位集合| 定義文件的欄位。推送或提取到索引的資料集必須提供每個欄位的值或 null，與結構描述中表達的資料類型和欄位長度相容。欄位有 [屬性](#index-attributes): 屬性或註解用來標記的欄位，可讓搜尋相關的行為，該欄位。例如，您可以逐一個別指定欄位是否可供搜尋、擷取或排序。您也可以指定欄位層級的語言分析器覆寫。
| [建議工具](https://msdn.microsoft.com/library/azure/mt131377.aspx)| 也稱為自動完成或自動提示查詢，會定義為索引中的區段。|
| [評分設定檔](https://msdn.microsoft.com/library/azure/dn798928.aspx)| 可讓設定檔所設定的特性較多的搜尋結果提升其排名的一組條件。比方說，假設某個搜尋詞彙在產品名稱和產品說明中都有相符項，您可能會想讓產品名稱中的相符項排名高於在說明中找到的相符項。您可以建立多個設定檔。|
| 預設評分設定檔| 您可以選擇性地將其中一個評分設定檔指定為預設值，以覆寫會計算搜尋排名分數的內建邏輯。|
| CORS 選項| 選擇性地讓跨來源資源共用，其中網頁所使用資源的要求會跨網域界限發出。CORS 一律為關閉，除非您特別為索引啟用它。|

<a name="index-attributes"></a>
## 索引屬性

個別欄位上設定的屬性可指定使用欄位的方式。 下表列舉您可以指定的屬性。

| **屬性**| 說明|
|------------|-----------|
| **Retrievable**| 指定搜尋結果中是否可傳回某欄位。|
| **Filterable**| 允許欄位用於 **$filter** 查詢中。|
| **Sortable**| 允許將欄位用作結果集中的排序欄位。|
| **Facetable**| 允許欄位用於使用者自我引導篩選的多面向導覽結構中。通常，欄位若包含您可以用來將多份文件群組在一起的重複值 (例如，落在單一品牌或服務類別目錄下的多份文件)，最適合做為 Facet。|
| **Key**| 字串，提供每一份文件的唯一識別碼，用於查閱文件。每個索引必須有一個索引鍵。只有一個欄位可以是索引鍵，而且它必須設定為 Edm.String。|
| **Searchable**| 將欄位標記為可供全文檢索。|


## 如何在 Azure 搜尋服務中使用索引？

從您的索引的資料用來建構在搜尋結果清單、 多面向導覽結構或針對單一文件的詳細資料] 頁面。 在 Azure 搜尋服務中，索引也可以包含非可搜尋資料，該資料是在內部用於篩選條件運算式中或在提供用來提升排名分數的搜尋準則的計分設定檔中。

Azure 搜尋服務所執行的所有資料相關作業，都會從索引取用或傳回資料。 此原則沒有例外：您無法將服務指向索引以外的其他資料來源，而在搜尋服務發出的回應中傳回外部資料。

顯然地，以會累積和操作資料的應用程式而言 (例如，線上零售應用程式的銷售交易)，Azure 搜尋服務索引將是您整個解決方案中額外的資料來源。 雖然讓專用資料儲存體僅用於搜尋似乎很多餘，但可提供下列優點：搜尋結果的一致性、降低變動性、減少您的應用程式與 Azure 搜尋服務之間的往返次數，以及改善搜尋作業的整體效能，因為沒有競用資源或資料的情形。

## 定義結構描述的指引

結構描述會建立為 JSON 結構。 您應為每個與 Azure 搜尋服務整合的自訂解決方案建立一個索引。 您無法連結或聯結多個索引，但您可以建立複雜索引，以容納您的解決方案所需的搜尋案例範圍。 例如，如果您的應用程式支援多種語言，則在索引的欄位集合中，每個欄位都可能會有語言特定變異。

當設計索引時，請在規劃階段花時間仔細考量每個決策。 在索引部署後若要加以變更，將牽涉到重建和重新載入資料。 如果您以程式碼建立索引，此步驟將會比以手動方式在入口網站中建立容易得多。

確實了解原始來源資料，是妥善建立結構描述所不可或缺的。 您將必須比對資料類型，確知要以哪個欄位做為「索引鍵」**欄位來唯一識別索引中的每個文件，以及應在搜尋結果清單或詳細資料頁面中公開哪個欄位。

**從關聯式資料開始**

關聯式資料難以轉換成一般資料集。 如果可能，請嘗試使用公司的資料倉儲或報告資料庫 (若有)。 因為模型已經反正規化，它通常是較佳的選擇。 否則，您必須依賴查詢以取得您需要的資料列集。 範例及如何執行這項操作的說明，請參閱 [Azure 搜尋服務的模型 AdventureWorks 庫存資料庫](http://blogs.technet.com/b/onsearch/archive/2015/09/08/modeling-the-adventureworks-inventory-database-for-azure-search.aspx)。

**包含二進位資料**

您可能想要在搜尋結果中具有影像、音訊或視訊內容。 在此情況中，檔案應該儲存在其他位置，索引包括具有資源 URL 的代表性欄位。 任何不可搜尋的內容 (尤其是二進位內容) 皆應儲存於費用較低廉的儲存體，然後由索引中某欄位內的 URI 加以參考。

**同步處理資料**

您可以想見，索引必須定期與您解決方案中使用的其他資料來源同步處理。 在線上零售目錄中，擷取銷售交易的庫存資料庫必須具有與透過搜尋結果呈現的資料相同的 SKU、價格和可用性。 根據您的解決方案所能接受的延遲程度，您的資料同步處理頻率可以是一週一次、一天一次，或並行寫入至庫存資料庫和 Azure 搜尋服務索引的接近即時。 [匯入資料到 Azure 搜尋服務](search-what-is-data-import.md) 說明可用之選項的詳細資料。

## 雲端中的儲存體

由於 Azure 搜尋服務是完全受管理的搜尋服務，因此資料儲存會以內部作業的形式處理。 身為程式設計人員，請務必了解您無法略過 Azure 搜尋服務 API 而直接連接到索引，也無法在未使用入口網站通知或 API 呼叫的情況下監視索引大小或健全狀況。 目前並沒有備份或還原索引的機制，也無法在儲存層上最佳化或調整效能。 資料會在幕後儲存為 blob 儲存體，但對於索引的實體儲存和管理，最恰當的思考方向是將其視為未來可能會變更的實作細節。 其中一個服務的主要優點是免動手的方法，才能實際管理計算資源的搜尋應用程式。

如果查詢磁碟區或資料儲存體需求會隨時間變更，您可以藉由新增或移動複本與資料分割來增加或減少容量。 如需詳細資訊，請參閱 [管理搜尋服務在 Azure 中的](search-manage.md) 或 [服務限制](search-limits-quotas-capacity.md)。



[1]: ./media/search-what-is-an-index/search-JSON-indexSchema.png 

