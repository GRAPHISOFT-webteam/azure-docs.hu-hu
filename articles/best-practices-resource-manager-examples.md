<properties
    pageTitle="實作範本最佳做法的內容範例"
    description="顯示說明最佳做法的 Azure 資源管理員範本範例。"
    services="azure-resource-manager"
    documentationCenter=""
    authors="mmercuri"
    manager="georgem"
    editor="tysonn"/>

<tags
    ms.service="azure-resource-manager"
    ms.workload="multiple"
    ms.tgt_pltfrm="na"
    ms.devlang="na"
    ms.topic="article"
    ms.date="08/13/2015"
    ms.author="mmercuri"/>


# 實作範本最佳做法的內容範例

本主題提供如何實作 Azure 資源管理員範本的 7 個內容範例。 


本主題是較大份白皮書的一部分。

## 將已設定功能範圍的範本移至已設定端對端解決方案範圍的範本

我們稍早共用了開發已設定功能範圍的範本模式。 


 


查看此案例時，最好一併查看可能涉及的資源數量。 
 
針對某些功能 (例如 Analysis Services)，您的拓撲很可能也會具備和它一起部署的 Active Directory。

針對此案例的兩個重要考量包括將如何使用 SQL Server 的週期，以及您想要套用到其中的 RBAC。 
如果 


另一個考量是您想要如何將 RBAC 套用到 SQL Server 已設定功能範圍的解決方案範本。 
 


 
 
 
 
 
這會建立較佳的已設定功能範圍的解決方案範本，因為它現在可以單獨使用或做為組合的一部分來使用。

評估是否應該從已設定端對端解決方案範圍的範本中傳入儲存體帳戶時，也應該重新評估 RBAC。 
 
 
 


 


## 使用多個已設定功能範圍的範本來建立已設定端對端解決方案範圍的範本

這主要是前一個範例的超集。 
 


 


在此案例中，會識別出有一個共用的虛擬網路和一個共用的儲存體帳戶。 
 
如果沒有，您可以修改已設定功能範圍的範本來配合這一點，如上一個範例所述。

針對您將新增的其他資源，您將會遵循用來建立個別已設定功能範圍的範本的模式超集。 
 
 
 


 


 
 


 
 


最後，您會希望考慮是否想要能夠定義和查詢資源之間的連結。 


## 利用部分開/關模式建立已設定端對端解決方案範圍的範本

這個案例是前一個案例的變化。 在此案例中，客戶會在一天的行程中以固定間隔來從內部部署系統中擷取資料。  
他們具有資料管線來處理這個內送的資料，以及一律可使用資料進行查詢的關聯式資料存放區。 


做為其資料管線的一部分，它們具備 SQL Server，來接收已處理的資料，並使用它來進行查詢。 


 


如前所述，在將建立和刪除其他資源的同時，SQL Server 部署會保持運作。 
 
 



 
 
 


 
 
 


## 支援訂用帳戶內的不同環境

 
設計適用於 Azure 的服務時，他們會利用他們的方法來進行過去曾使用的訂用帳戶資料分割，以滿足這些需求。

 
 


本節探討適用於這些環境類型的需求，並提供如何傳遞使用 ARM 來滿足它們之環境的相關指引。

### 隔離考量

本節將更詳細地探討適用於環境、計費及地理位置隔離的常見客戶驅動程式。

#### 環境隔離

服務擁有者想要隔離他們的不同環境。 
 
 


#### 計費隔離 - 開發與執行服務

 


 


#### 計費隔離 - 將透明度和權責加入服務取用成本中

 


 
 
 


 


#### 地理導向的隔離 - 特有且受到特定地理位置之法律所規範的部署

 


 
 


地理位置隔離也提供了利用新的平台服務和功能的優點。 


 


### 相容性考量

服務可以跨多個地理位置傳遞至縱向市場。 


#### 分隔角色和責任

分隔角色與責任是內部服務要與內部原則相容的主要需求。 
 
許多服務已建立樣板來提供下列兩個功能：RBAC 和稽核。

#### 角色型存取控制 (RBAC) 使用案例

在相容性案例中，請務必限制某些資源的存取權。

 
 


在已識別的情況下，RBAC 可為不同的個人、系統或群組提供特定資源的存取權。

#### 稽核

除了 RBAC 所提供的存取限制之外，組織也需要稽核資源存取，以及與資源之間的互動。

### 使用 Azure 資源管理員進行實作

組織先前就曾使用訂用帳戶資料分割來達成這些目標。 儘管可行，但這不理想。 
 
 
 


使用資源管理員，在一個訂用帳戶內部署多個環境會變得更容易。 


環境可以放置於資源群組中，可將特定的 RBAC 套用到它們，讓您能夠提供環境隔離。 
 


您可以將標記套用到資源和資源群組，在進行帳單彙總和摘要檢視時用來提供計費隔離。 


稽核需求會當成基礎 Azure 資源管理員的一組全新功能來提供，並可在中央位置進行檢視。

 


#### 將密度最佳化

儘管已在 Azure 資源管理員中放寬資源限制，但仍會有限制。 
 
 


您可以選擇針對不同的 T 恤尺寸使用不同的訂用帳戶來達成更高的密度。 
 
 


 


其中一個方法是讓客戶可以在其現有的資源群組內取得額外容量。 
 
 
 
 


儘管可行，但比起一般處理方法來說這是不盡理想的，雖然它可達成較低密度，但需要更多要管理的額外負荷。 
 


另一種方法是刪除客戶目前大小的環境，並建立不同大小的新環境。 


 
 


替代的方法是提供受管理的服務，以配合這個從某個大小到另一個大小的轉換。 


## 提供含有其他客戶原則限制的環境

某些組織對於他們部署的環境具有額外的需求與原則。 

針對支援能力和成本考量，也可能會限制使用者可以建立、更新或刪除哪些資源。
針對提供環境的組織，他們通常也需要存取訂用帳戶以取得支援。

 


您可以使用角色型存取控制，來限制使用者建立、更新或刪除特定資源的能力。 


您可以實作資源鎖定來建立唯讀或無法刪除的資源。 


 


虛擬應用裝置無非就是一個 VM，可執行用來以某種方式處理網路流量的應用程式，例如防火牆或 NAT 裝置。 
有許多協力廠商會在 Azure 上提供虛擬網路應用裝置，而組織也可以自備。

「自備」應用裝置的方法讓組織能夠重複使用現有的程式碼，該程式碼可能已在其內部部署環境中使用。 
 


如同先前的範例，您應檢閱資源的週期和 RBAC 限制，並將其視為資源群組策略的一部分。

## 保護資源以防止內部的不良執行者

針對組織的其中一個考量可能是保護他們的資源，以及由不良執行者佈建它們的範本。

 


 


Azure 金鑰保存庫可與 ARM 搭配使用，來協調和儲存 VM 密碼和憑證。

 


金鑰保存庫中儲存的密碼受到受信任的操作員的完整 RBAC 控制。 


 
這樣做可降低以網路釣魚方式詐騙密碼的機會，以及限制不良執行者進行變更的能力。

如同文件稍早所述，並未提供通用的金鑰保存庫。 由於金鑰保存庫永遠是地區性的，因此，密碼與 VM 永遠具有區域性 (以及主權)。

這種方法的實作範例已在＜密碼和憑證＞一節中提供，您可以在本文件稍早內容中找到此節。

## 啟用「自備訂用帳戶」模型

企業 IT、系統整合者和雲端服務廠商可能會對客戶採用「自備訂用帳戶」模型。 


這個方法有各種不同變化，每個都有些微不同的需求，詳情如下。

### 讓協力廠商有權監視帳戶內的資源

具有監視應用程式的組織可能需要客戶訂用帳戶的唯讀存取權，來擷取要在該應用程式中使用的資料。 
此動作在持續使用期間都需要有唯讀存取權。 


#### 使用 Azure 資源管理員進行實作

 
 


### 讓協力廠商能夠存取一次性部署的軟體

 


#### 使用 Azure 資源管理員進行實作

這會遵循類似先前範例的方法。

 


### 讓協力廠商有權使用客戶的訂用帳戶來儲存資料

在另一個範例中，組織可能想要在自己的環境中執行軟體，但使用客戶的帳戶來儲存。 
 
 


#### 使用 Azure 資源管理員進行實作

這是使用與其他範例相同的模式來實作。 服務主體會被授與儲存體資源的存取權。 


 
針對這方面的案例，您會將資源鎖定套用到儲存體帳戶。

### 透過協力廠商啟用服務管理

在另一個範例中，組織想要部署、監視和管理客戶訂用帳戶中的軟體。 


#### 使用 Azure 資源管理員進行實作

這會遵循本節一開始所識別的模式超集。 


此外，如果有客戶限制，就會為來自客戶的使用者或群組授與適當的權限來利用環境。  
這可透過範本來完成，如本節稍早內容中所提及。

最後，可能想要確保特定資源不會遭到意外刪除。 


## 後續步驟

- 
- 
- 





