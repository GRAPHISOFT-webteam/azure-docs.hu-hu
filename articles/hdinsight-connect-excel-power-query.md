<properties urlDisplayName="HDInsight and Excel" pageTitle="Connect Excel to Hadoop with Power Query | Azure" metaKeywords="hdinsight, excel, data explorer, hive excel, hdinsight excel, power query" description="Learn how to take advantage of business intelligence components and use Excel to access data stored in Azure HDInsight using Power Query." metaCanonical="" services="hdinsight" documentationCenter="" title="Connect Excel to Hadoop with Power Query" authors="bradsev" solutions="" manager="paulettm" editor="cgronlun" />

<tags ms.service="hdinsight" ms.workload="big-data" ms.tgt_pltfrm="na" ms.devlang="na" ms.topic="article" ms.date="01/01/1900" ms.author="bradsev"></tags>

# Connect Excel to Hadoop with Power Query

One key feature of Microsoft's big data solution is the integration of Microsoft Business Intelligence (BI) components with Hadoop clusters in HDInsight. A primary example of this integration is the ability to connect Excel to the Azure storage account containing the data associated with your Hadoop cluster by using Microsoft Power Query for Excel. This article walks you through how to set up and use Power Query from Excel to query data associated with an Hadoop cluster managed with HDInsight.

**Prerequisites**

Before you begin this article, you must have the following:

-   A HDInsight cluster. To configure one, see [Get started with Azure HDInsight][Get started with Azure HDInsight].
-   A computer that is running Windows 8, Windows 7, Windows Server 2012, or Windows Server 2008 R2.
-   Office 2013 Professional Plus, Office 365 Pro Plus, Excel 2013 Standalone, or Office 2010 Professional Plus.

## In this article

-   [Install Microsoft Power Query for Excel][Install Microsoft Power Query for Excel]
-   [Import data into Excel][Import data into Excel]
-   [Next steps][Next steps]

## <span id="InstallPowerQuery"></span></a>Install Microsoft Power Query for Excel

Power Query can be used to import data from a variety of sources into Microsoft Excel, where it can power Business Intelligence (BI) tools like PowerPivot and Power View. In particular, Power Query can import data that has been output or that has been generated by a Hadoop job running on an HDInsight cluster.

Download Microsoft Power Query for Excel from the [Microsoft Download Center][Microsoft Download Center] and install it.

## <span id="ImportData"></span></a>Import HDInsight data into Excel

The Power Query add-in for Excel makes it easy to import data from your HDInsight cluster into Excel where business intelligence tools such as PowerPivot and Power Map may be used to inspect, analyze, and present the data.

**To import data from an HDInsight cluster**

1.  Open Excel.

2.  Create a new blank workbook.

3.  Click the **Power Query** menu, click **From Other Sources**, and then click **From Azure HDInsight**.

    ![HDI.PowerQuery.SelectHdiSource][HDI.PowerQuery.SelectHdiSource]

    Note: If you don't see the **Power Query** menu, go to **File** \> **Options** \> **Add-Ins**, and select **COM Addins** from the drop-down **Manager** box at the bottom of the page. Select the **Go...** button and verify that the box for the Microsoft Office Power Query for Excel Add-In has been checked.

4.  Enter the **Account Name** of the Azure Blob storage account associated with your cluster, and then click **OK**.

5.  Enter the **Account Key** for the Blob storage account, and then click **Save**. (You need to do this only the first time you access this store.)

6.  In the **Navigator** pane on the left of the **Query Editor**, double-click the Blob storage container name. By default the container name is the same name as the cluster name.

7.  Locate **HiveSampleData.txt** in the **Name** column (the folder path is **../hive/warehouse/hivesampletable/**), and then click **Binary** on the left of HiveSampleData.txt.

    ![HDI.PowerQuery.ImportData][HDI.PowerQuery.ImportData]

8.  If you want, you can rename the column names. When you are ready, click **Apply & Close**.

    ![HDI.PowerQuery.ImportedTable][HDI.PowerQuery.ImportedTable]

## <span id="NextSteps"></span></a>Next steps

In this article you learned how to use Power Query to retrieve data from HDInsight into Excel. Similarly, you can retrieve data from HDInsight into SQL Azure. It is also possible to upload data into HDInsight. To learn more, see the following articles:

-   [Connect Excel to HDInsight with the Microsoft Hive ODBC Driver][Connect Excel to HDInsight with the Microsoft Hive ODBC Driver]
-   [Upload Data to HDInsight][Upload Data to HDInsight].

  [Get started with Azure HDInsight]: ../hdinsight-get-started/
  [Install Microsoft Power Query for Excel]: #InstallPowerQuery
  [Import data into Excel]: #ImportData
  [Next steps]: #NextSteps
  [Microsoft Download Center]: http://go.microsoft.com/fwlink/?LinkID=286689
  [HDI.PowerQuery.SelectHdiSource]: ./media/hdinsight-connect-excel-power-query/HDI.PowerQuery.SelectHdiSource.png
  [HDI.PowerQuery.ImportData]: ./media/hdinsight-connect-excel-power-query/HDI.PowerQuery.ImportData.png
  [HDI.PowerQuery.ImportedTable]: ./media/hdinsight-connect-excel-power-query/HDI.PowerQuery.ImportedTable.PNG
  [Connect Excel to HDInsight with the Microsoft Hive ODBC Driver]: ../hdinsight-connect-excel-hive-ODBC-driver/
  [Upload Data to HDInsight]: ../hdinsight-upload-data/
