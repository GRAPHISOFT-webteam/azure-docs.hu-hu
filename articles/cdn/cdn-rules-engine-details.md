<properties 
    pageTitle="Azure 內容傳遞網路 (CDN) 規則引擎比對條件和功能詳細資料" 
    description="本主題會針對 Azure 內容傳遞網路 (CDN) 規則引擎，列出可用比對條件和功能的詳細說明。" 
    services="cdn" 
    documentationCenter="" 
    authors="camsoper" 
    manager="dwrede" 
    editor=""/>

<tags 
    ms.service="cdn" 
    ms.workload="media" 
    ms.tgt_pltfrm="na" 
    ms.devlang="na" 
    ms.topic="article" 
    ms.date="12/02/2015" 
    ms.author="casoper"/>


# CDN 規則引擎比對條件和功能詳細資料
    
本主題列出的詳細的描述使用的比對條件和功能的 Azure 內容傳遞網路 (CDN) [規則引擎](cdn-rules-engine.md)。

> [AZURE.NOTE] 規則引擎需要高階 CDN 層。  多個功能的標準和高階 CDN 層的詳細資訊，請參閱 [Azure 內容傳遞網路概觀](cdn-overview.md)。

## 比對條件

比對條件會識別特定類型的要求，系統將針對這類要求執行一組功能。 

例如，可能會使用它來篩選對於特定位置之內容的要求、產生自特殊 IP 位址或國家/地區的要求，或是依標頭資訊篩選要求。 

### 一律

「一律」比對條件可設計來將一組預設功能套用至所有要求。 

### 裝置

「裝置」比對條件可識別從行動裝置根據其屬性所提出的要求。

### 位置

這些比對條件是設計來根據要求者的位置識別要求。

名稱 | 目的
-----|--------
AS 號碼 | 識別源自特定網路的要求。
國家 (地區) | 識別源自特定國家/地區的要求。
 

### 來源

這些比對條件是設計來識別指向 CDN 儲存體或客戶原始伺服器的要求。

名稱 | 目的
-----|--------
CDN 原點 | 識別對儲存於 CDN 儲存體之內容的要求。
客戶原點 | 識別對儲存於特定客戶原始伺服器上之內容的要求。


### 要求

這些比對條件是設計來根據要求的位置識別它們。 

名稱 | 目的
-----|--------
用戶端 IP 位址 | 識別源自特定 IP 位址的要求。
Cookie 參數 | 檢查與每個適用於指定值之要求相關聯的 Cookie。
Cookie 參數 Regex | 檢查與每個適用於規則運算式之要求相關聯的 Cookie。
邊緣 Cname | 識別指向特定邊緣 CNAME 的要求。
轉介網域 | 識別從指定主機名稱轉介的要求。
要求標頭常值 | 識別包含設為指定值之指定標頭的要求。
要求標頭 Regex | 識別包含指定標頭的要求，該標頭已設定為符合特定規則運算式的值。
要求標頭萬用字元 | 識別包含指定標頭的要求，該標頭已設定為符合特定模式的值。
要求方法 | 依其 HTTP 方法來識別要求。
要求配置 | 依其 HTTP 通訊協定來識別要求。

### URL

這些比對條件是設計來根據要求的 URL 來識別它們。

名稱 | 目的
-----|--------
URL 路徑目錄 | 依其相對路徑來識別要求。
URL 路徑的副檔名 | 依其副檔名來識別要求。
URL 路徑的檔案名稱 | 依其檔案名稱來識別要求。
URL 路徑常值 | 比較要求的相對路徑與指定的值。
URL 路徑 Regex | 比較要求的相對路徑與指定的規則運算式。
URL 路徑萬用字元 | 比較要求的相對路徑與指定的模式。
URL 查詢常值 | 比較要求的查詢字串與指定的值。
URL 查詢參數 | 識別包含指定查詢字串參數的要求，該參數已設定為符合特定模式的值。
URL 查詢 Regex | 識別包含指定查詢字串參數的要求，該參數已設定為符合特定規則運算式的值。
URL 查詢萬用字元 | 根據要求的查詢字串來比較指定的值。

## 特性

功能會定義動作類型，其將套用到透過一組比對條件來識別的要求類型。 

### Access

這些功能是設計來控制內容的存取權。 

名稱 | 目的
-----|--------
拒絕存取 | 判斷所有要求是否已遭拒絕且含有 [403 禁止] 回應。
權杖驗證 | 判斷是否要將權杖型驗證套用到要求。 
權杖驗證拒絕代碼 | 判斷在要求因權杖型驗證而遭到拒絕時將傳回給使用者的回應類型。 
權杖驗證會忽略 URL 的大小寫 | 判斷透過權杖型驗證所做的 URL 比較是否會區分大小寫。 
權杖驗證參數 | 判斷是否應將權杖型驗證查詢字串參數重新命名。

### 快取

這些功能是設計來自訂快取內容的時機和方法。

名稱 | 目的
-----|--------
頻寬參數 | 判斷是否將會使用頻寬節流設定參數 (例如 ec_rate 和 ec_prebuf)。
頻寬節流設定 | 針對我們的 Edge Server 所提供的回應進行頻寬節流設定。 
略過快取 | 判斷要求是否可以利用我們的快取技術。
Cache-Control 標頭處理 | 當 [外部最大壽命] 功能為作用中時，透過 Edge Server 來控制 Cache-Control 標頭的產生。
快取索引鍵查詢字串 | 判斷快取索引鍵是否將包含或排除與要求相關聯的佇列字串參數。 
快取索引鍵重寫 | 重寫與要求相關聯的快取索引鍵。 
完成快取填滿 | 判斷在要求於 Edge Server 上產生部分快取遺失時會發生什麼事。 
壓縮檔案類型 | 定義將在伺服器上壓縮的檔案格式。 
預設的內部最大壽命 | 判斷 Edge Server 到原始伺服器快取重新驗證之間的預設最大壽命間隔。
Expires 標頭處理 | 當 [外部最大壽命] 功能為作用中時，透過 Edge Server 來控制 Expires 標頭的產生。 
外部最大壽命 | 判斷瀏覽器到 Edge Server 快取重新驗證之間的最大壽命間隔。 
強制執行內部最大壽命 | 判斷 Edge Server 到原始伺服器快取重新驗證之間的最大壽命間隔。 
H.264 支援 (HTTP 漸進式下載) | 判斷可能用於串流處理內容的 H.264 檔案格式類型。 
接受 No-Cache 要求 | 判斷是否要將 HTTP 用戶端的 no-cache 要求轉送到原始伺服器。
忽略原始的 No-Cache | 判斷我們的 CDN 是否將忽略原始伺服器所提供的特定指示詞。
忽略無法滿足的範圍 | 判斷在要求產生「416 無法滿足的要求範圍」狀態代碼時將傳回用戶端的要求。 
內部最大過時 | 控制當 Edge Server 無法使用原始伺服器重新驗證快取的資產時，從 Edge Server 所提供的快取資產可能會經歷多長的標準到期時間。
部分快取共用 | 判斷要求是否可以產生部分快取的內容。 
預先驗證快取的內容 | 在快取內容的 TTL 到期之前，判斷其是否適用進行早期重新驗證。 
重新整理零位元組的快取檔案 | 判斷如何透過我們的 Edge Server 來處理 HTTP 用戶端對於 0 位元組快取資產的要求。
設定可快取的狀態碼 | 定義一組可產生快取內容的狀態碼。 
發生錯誤時傳遞過時的內容 | 判斷在快取重新驗證期間發生錯誤時，或者在接收到來自客戶原始伺服器的要求內容時，是否要傳遞到期的快取內容。
在重新驗證時過期 | 允許我們的 Edge Server 在進行重新驗證時提供過時的用戶端給要求者，藉以改善效能。 
註解 | 「註解」功能能夠在規則中新增附註。 

### 標頭

這些功能是設計來新增、修改或刪除要求或回應的標頭。

名稱 | 目的
-----|--------
Age 回應標頭 | 判斷 Age 回應標頭是否將包含於傳送到要求者的回應中。 
偵錯快取回應標頭 | 判斷回應是否會包含於 X-EC-Debug 回應標頭中，其會在快取原則上提供要求資產的相關資訊。
修改用戶端要求標頭 | 覆寫、附加或刪除要求的標頭。
修改用戶端回應標頭 | 覆寫、附加或刪除回應的標頭。
設定用戶端 IP 自訂標頭 | 允許將要新增到要求的要求用戶端 IP 位址做為自訂要求標頭。 

### 記錄檔

這些功能是設計來自訂儲存於原始記錄檔中的資料。

名稱 | 目的
-----|--------
自訂記錄欄位 1 | 判斷將指派給原始記錄檔中自訂記錄欄位的格式和內容。 
記錄查詢字串 | 判斷查詢字串以及 URL 是否將一起儲存於存取記錄中。

### 最佳化

這些功能會判斷要求是否將經歷 Edge 最佳化工具所提供的最佳化。

名稱 | 目的
-----|--------
Edge 最佳化工具 | 判斷 Edge 最佳化工具是否可套用至要求。 
Edge 最佳化工具 - 具現化設定 | 具現化或啟用與網站相關聯的 Edge 最佳化工具組態。 
 

### 來源

這些功能是設計來控制 CDN 與原始伺服器通訊的方式。

名稱 | 目的
-----|--------
Keep-Alive 要求的最大值 | 判斷在關閉 Keep-Alive 連線之前，適用於該連線的最大要求數目。 
Proxy 特定的標頭 | 定義將從 Edge Server 轉送到原始伺服器之 CDN 特定的要求標頭組。 

### 特殊性

這些功能提供的進階功能僅可供進階使用者使用。

名稱 | 目的
-----|--------
可快取的 HTTP 方法 | 判斷可在我們的網路上快取的其他 HTTP 方法組。
可快取的要求主體大小 | 定義用以判斷是否可快取 POST 回應的臨界值。 
 

### URL

這些功能可讓要求重新導向至不同的 URL 或重寫為不同的 URL。

名稱 | 目的
-----|--------
遵循重新導向 | 判斷要求是否可以重新導向至定義於客戶原始伺服器所傳回之位置標頭中的主機名稱。 
[URL 重新導向] | 透過位置標頭將要求重新導向。 
URL 重寫  | 重寫要求 URL。 

### Web 應用程式防火牆

Web 應用程式防火牆功能會判斷要求是否將由 Web 應用程式防火牆進行篩選。 

## 另請參閱
* [Azure CDN 概觀](cdn-overview.md)
* [使用規則引擎覆寫預設的 HTTP 行為](cdn-rules-engine.md)

